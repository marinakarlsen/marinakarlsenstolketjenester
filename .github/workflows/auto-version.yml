name: Oppdater versjonsnummer

on:
  push:
    branches:
      - main  # Endres hvis hovedgrenen din heter noe annet

jobs:
  update-version:
    runs-on: ubuntu-latest

    steps:
    - name: Sjekk ut koden
      uses: actions/checkout@v3

    - name: Øk versjonsnummer
      id: bump_version
      run: |
        # Les inn gjeldende versjon
        current_version=$(jq -r '.version' version.json)

        # Øk patch-delen av versjonsnummeret
        new_version=$(echo $current_version | awk -F. '{printf "%d.%d.%d", $1, $2, $3+1}')

        # Oppdater versjonsfilen
        echo "{ \"version\": \"$new_version\" }" > version.json
        echo "Versjon oppdatert til: $new_version"

    - name: Commit og push endringer
      run: |
        git config user.name "GitHub Actions Bot"
        git config user.email "actions@github.com"
        git add version.json
        git commit -m "Oppdatert versjon automatisk til $new_version"
        git push
